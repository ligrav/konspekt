Конспект по Барбешоп 1С - 1 час

Конспект Конфигурация 1С с нуля за 5 часов. Барбершоп

***Цель*** 
Создание конфигурации для компании Барбершоп
Понимать какой мастер обслуживает клиентов
Какую услугу он выполняет, стоимость услуги
Произвести под конец аналитику, какую зарплату выдать сотрудникам и т.д

План
Создать базу без конфигурации
Создадим структуру хранения данных
	Справочники
	Документы
	Регистры
Они позволят хранить в базе данные и позволят хранить данные
Создадим журнал в вдие планировщика, где можно на конкретную
 дату видеть загруженность мастеров
Займемся Интерфейсом
	

Конфигурация
	Свойства - Имя конфигурации Барбершоп
		Поставщик - Ironskills
		Версия 1.0.1.1
		Краткая информация - Барбершоп
		Подробная информация - Барбершоп
		Заставка - выбрать картинку для барбершопа из гугла .png

Справочники
	Основные - Салоны, ПО - Салон создаем
		Реквизиты
			Адрес, строка
			Телефон, строка

Платформа
	Заполняем справочник
	 
Конфигурация
  Справочник Услуги создаем
  	Реквизиты
  		Длительность - Число
 
Платформа
	Услуги Заполняем
 
Конфигурация
Хотим добавить регистр сведений для Цен на услуги

> РегистрСведений Цены
		Основные - Цены, В пределах дня, Независимый
		Данные 
			Измерения
				Услуга -  ведущие, Запрет незаполненных значений, справочник услуга, выдавать ошибку
			Ресурсы
				Цена, Число, 10, 2, Неотрицательное

Платформа
	Заполняем цены

Конфигурация
	Справочник - Сотрудники
		У реквизитов выдавать ошибку ибо они важны
	Справочник - Должность для того что бы реквизит Сотрудников на него ссылался
	
Платформа
	Заполняем сотрудников

Конфигурация
	Справочник - создаем клиенты
		Реквизиты
			Телефон, строка
			АдресЭП, строка
			ДатаРождения, дата
			Коментарий, строка

Платформа
	
	Добавим несколько клиентов
			
Теперь нам необходимо понимать в какие дни недели и в какое время будет работать наш салон

Конфигурация

	Справочники - Салоны
		Табличная Часть
			РабочийДень - Булево
			ДниНедели. Мы не хотим что бы пользователь строкой создавал дни недели, поэтому они будут в Перечисления

			ВремяНачала - Дата, Время
			ВремяОкончания - Дата, Время

	Перечисления
		ДниНедели
			Значения
				Понедельние - Воскресенье

Платформа
	
	Открыли в Салонах Барбершоп и в табличной части видим таблицу, мы хотим что бы дни недели были там изначально 
	А время там с точностью ддо секунд, что нам не нужно

Конфигурация
	
	Справочники
		Салоны
			Формы
				Командная панель - убираем автозаполнение (Убирает лишние кнопки с панели)
				РежимРаботы - Свойства - Изменение состава строк - снять галочку (что бы пользователь не добавлял свои недели и не заполнял таблицу)
				Номер столбца удаляю
				РабочийДень - убираю заголовок, выбрать картинку установить флажок
				Формат, ФорматРедактирования у  Время начала и окончания - ЧЧ:мм

Что бы записать в табличную часть дни недели
	Салоны - Модуль объекта

Процедура ОбработкаЗаполнения(ДанныеЗаполнения, ТекстЗаполнения, СтандартнаяОбработка)
	
	ОбъектМетаданных = Метаданные.Перечисления.ДниНедели;    
	
	Для каждого ЗначениеПеречисления Из ОбъектМетаданных.ЗначенияПеречисления Цикл
	
		СтрокаТЧ = РежимРаботы.Добавить();
		СтрокаТЧ.ДеньНедели = Перечисления.ДниНедели[ЗначениеПеречисления.Имя]; 
		СтрокаТЧ.ВремяНачала = '000101010900';
		СтрокаТЧ.ВремяОкончания = '000101011900';

		
	КонецЦикла;
	
КонецПроцедуры

Теперь для регистрации записей будем использовать документы
	Документы - Запись
		Периодичность в пределах года, с каждым новым годом запись будет нумероваться с самого первого
		Оперативное проведение запретить - что бы мы могли записывать пациентов будущей датой
		Реквизиты - Салон, сотрудники, услуга, Длительность, Сумма, Клиент

Конфигурация
	В документе дата стоит в одном поле, 
	Формы документа  Делаим дату  на дату и время, время с точностью до минуты, секунды не нужны
	расположить по горизонтали
		Это делается в форме

	При выборе услуги Длительность и сумма должна выбирать автоматически
		Для этого необходим обработчик событий

	В конструкторе запроса нам необходимы 
		поля
		 Услуги.Длительность, ЦеныСрезПоследних.Цена(ЕстьNull)
			Параметры ЦеныСрезПоследних 
				Услуга = &Услуга
		Связи
			Услуги, ЦеныСрезПоследних - левое соединение, условие связи Услуги.Ссылка совпадает с ЦенамиСрезПоследних.Услуга
		Объединение/Псевдонимы
			Поле1 это Цена
		Условия
			Услуги.Ссылка = Услуга
		Ок

Код находится в Документе Запись - Формы 

Благодаря коду   При выборе Услуги - Длительность и Сумма заполняются автоматически

Убираем у формы времени выбор календаря

Создаем документ 
	Продажа 
		Данные копируем из справочника
			Салон, Сотрудник, Услуга, Клиент, Сумма, Коментарий

57 мин

Видно, что после записи приходится создавать документ продажа, что довольно таки неудобно, поэтому наша цель их связать
Для этого есть механизм ввод на основании
В конструкторе автоматически он создается и готово, теперь Продажи заполняются автоматически

Теперь нужно сделать так что бы клиенты могли оплатить

	Перечисления - СпособыОплаты
		Наличные
		Карта

	Документ
		Создаем - Оплата
			Реквизиты: Салон, клиент, сумма, запись, СпособОплаты
			СпособОплаты - Представление Наличные, Выдавать ошибку

Конец первого часа
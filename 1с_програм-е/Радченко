В этих заметках я описываю действия по созданию конфигурации по книги

234 стр 

1. Установил базу 1с:Предприятие и создал пустую базу данных
   Даем имя конфигурации - ПособиеДляНачинающих
2. Подсистемы
   Создаем в нашей конфигурации подсистемы и даем им иконки, которые были включены в доп материалы 
   В командном интерфейсе распологаем подсистемы как они указаны ниже
   УчетМатериалов
   ОказаниеУслуг
   Бухгалтерия
   РасчетЗарплаты
   Предприятие

3.Справочники
   
   Сначала создаем список сотрудников и список клиентов
   Справочник - Клиенты, П.О - Клиент, ПС - Клиенты
   Подсистемы - бухгалтерия, ОказаниеУслуг
   Видим, что в подсистеме Бухгалтерия и ОказаниеУслуг добавились справочники
   Данные - Длина наименования 50 
   Меняем синоним у стандартного реквизита "Наименование" на синоним "Ф.И.О.", Проверка заполнения - Выдавать ошибку
   Добавляем в Командный интерфейс "ОказаниеУслуг" Клиент - Создать, для того что бы было проще из подсистемы оказание услуг создать новый справочник
   Добавляем Клиентов в Платформе
      Иванов Михаил Юрьевич
      Роман
      Спиридонова Галина
   Добавляем новый объект конфигурации Справочник -Сотрудники, ПО Сотрудник, РПС - Список сотрудников
   Подсистемы - Оказание услуг, Расчет запрплаты
   Данные - длина наименования - 50 
   Синоним Наименование - Ф.И.О.

   Табличная часть 
   Создать Табличную часть - ТрудоваяДеятельность
   Реквизиты 
      Организация - Строка -, длина 100
      НачалоРаботы - Дата, состав даты - Дата
      ОкончаниеРаботы - Дата, состав даты - Дата
      Должность - Строка, длина 100
      Подсистема Расчет зарплаты, Командный интерфейс - Сотрудник: создать


Заполняем табличную часть в 1С платформе  стр 94
Создадим следующих сотрудников

   Гусаков Николай Дмитриевич.
   Трудовая деятельность:
      Организация – ЗАО «НТЦ»,
      Начало работы – 01.02.2009,
      Окончание работы – 16.04.2012,
      Должность – Ведущий специалист.
   Деловой Иван Сергеевич.
   Трудовая деятельность:
      1:
      Организация – ООО «Автоматизация»,
      Начало работы – 22.01.2006,
      Окончание работы – 31.12.2012,
      Должность – Инженер.
      2:
      Организация – ЗАО «НПО СпецСвязь»,
      Начало работы – 20.06.1996,
      Окончание работы – 21.01.2005,
      Должность – Начальник производства.
   Симонов Валерий Михайлович.
   Трудовая деятельность:
      Организация – ООО «СтройМастер»,
      Начало работы – 06.02.2009,
      Окончание работы – 03.04.2012,
      Должность – Прораб.

Создаем справочник Номенклатура
   
   Создаем справочник - Номенклатура
   Подсистемы - Учет материалов, Оказание услуг и Бухгалтерия
   Иерархия - Иерархический справочник - Вид иерархии - Иерархия групп и элементов 
   Данные - длина наименование 100 символов
   Стандартный реквизит - Родитель меняем синоним на Группа номенклатуры 

Подсистемы - Все подсистемы - УчетМатериалов - Номенклатура:Создать - галочка
ОказаниеУслуг - те же действия 

В латформе заполняем данные справочника - стр 102  
   
   Создаем две группы 
      Материалы, услуги
   Затем двойным щелчком мыши раскроем группу Материалы  и создадим в ней пять элементов:
       Строчный трансформатор Samsung,
       Строчный трансформатор GoldStar,
       Транзистор Philips 2N2369,
       Шланг резиновый,
       Кабель электрический.
   В группе Услуги добавляем две группы с элеиентами 
   Услуги по ремонту телевизоров
      Диагностика
      Ремонт отечественного телевизора
      Ремонт импортного телевизора 
   Услени по установке стиральных машин
      Подключение вода
      Подключение электричества 

Затем в группе Материалы создадим две группы: Радиодетали
и Прочее. В группу Прочее поместим Кабель электрический и Шланг
резиновый. Остальные материалы переместим в группу Радиодетали

107 страница так выглядит заполненый справочник 

   Создаем справочник - Склады, ПО - Склад 
   Подсистемы - Оказание услуг и Учет материалов
   Поле ввода - Быстрый выбор, это для удобства
   Заранеее создаем элемент справочника в конфигурации
   Прочее - Предопределенные - Добавить - Имя Основной, Наменование - Основной 
Подсистемы 
   Учет материалов - Командный интерфейс - Склад: создать 

Стр 121
Документы 
   
   Мы создадим два документа "Приходная накладная" и "Оказание услуги"

   Приходная накладная будет фиксировать факт поступление материалов в организация
   Оказание услуги будет фиксировать оказание услуг и расход материалов

   Документ - ПриходнаяНакладная, ПС - Приходные накладные 
   Подсистемы: Учет материалов и Бухгалтерия
   Данные Реквизиты - Склад - СправочникСсылка.Склады, Значение заполнения Основной  
   Таким образом, при создании нового документа склад будет сразу заполняться значением Основной, и пользователю не придется делать это вручную

   Добавляем табличную часть - Материалы , Проверка заполнения - выдавать ошибку
      Материал, тип СправочникСсылка.Номенклатура
      Количество, тип Число, длина 15, точность 3, неотрицательное
      Цена, тип Число, длина 15, точность 2, неотрицательное
      Сумма, тип Число, длина 15, точность 2, неотрицательное 
   У каждого элемента табличной части задать Проверка заполнения - Выдавать ошибку 

   Нумерация - Автонумерация - включено 
   Учет матиралов - командный интерфейс - Приходная накладная: создать 

1С Платформа Стр 135
   Создаем документ, видим что склад уже выбран
   Заполняем документ
      Строчный трансформатор GoldStar  10,  270,  2700
      Строчный трансформатор Samsung   10,  600,  6000
      Транзистор Philips 2N2369        10,    3,  30

Нажимаем Провести и закрыть 

   Создаем второй документ 
   Кабель электрический    5,   20,  100
   Шланг резиновый         5,  100,  500

Нажимаем Провести и закрыть 

Конфигурация

Цель Автоматическое заполнение суммы в платформе методом умножения количества на цену
Для этого стандартную форму нам необходимо изменить

   Создаем Форма документа и нажимаем Готово
Создаем общий модуль, так как определенный участок кода будет дублироваться

   Общие модули - РаботаСДокументами, Клиент

Процедура РасчитатьСумму(СтрокаТабличнойЧасти) Экспорт
   СтрокаТабличнойЧасти.Сумма = СтрокаТабличнойЧасти.Количество * СтрокаТабличнойЧасти.Цена; 
КонецПроцедуры

Используем общий модуль для событий в документе ПриходнаяНакладная 

   Берем МатериалыКоличество, МатериалыЦены  - ПриИзменении - НаКлиенте

&НаКлиенте
Процедура МатериалыКоличествоПриИзменении(Элемент)
   СтрокаТабличнойЧасти = Элементы.Материалы.ТекущиеДанные;
   РаботаСДокументами.РасчитатьСумму(СтрокаТабличнойЧасти);
КонецПроцедуры

&НаКлиенте
Процедура МатериалыЦенаПриИзменении(Элемент)
   СтрокаТабличнойЧасти = Элементы.Материалы.ТекущиеДанные;
   РаботаСДокументами.РасчитатьСумму(СтрокаТабличнойЧасти);
КонецПроцедуры

в 1С Платформе можно проверить как в документах сумма считается автоматически 

Документ Оказание услуги
   
   Создаем документ - ОказаниеУслуги, ПС Оказание услуг 
   Подсистемы: Оказание услуг и Бухгалтерия
   Данные: создаем реквизиты
      Склад, тип СправочникСсылка.Склады, Значение заполнения предопределенный элемент Основной справочник Склады
      Клиент, тип СправочникССылка.Клиенты, Проверка заполнения - Выдавать ошибку
      Мастер СправочникСсылка.Сотрудники, Проверка заполнения - Выдавать ошибку
   Создадим табличную часть
      Номенклатура, тип СправочникСсылка.Номенклатура
      Количество, тип Число, длина 15, точность 3, неотрицательное
      Цена, тип Число, длина 15, точность 2, неотрицательное
      Сумма, тип Число, длинна 15, точность 2, неотрицательное 
   Для каждого реквизита Проверка заполнения - Выдавать ошибку

   В форме ПереченьНоменклатурыКоличество и ПереченьНоменклатурыЦена. При Изменении, НаКлиенте 

&НаКлиенте
Процедура ПереченьНоменклатурыКоличествоПриИзменении(Элемент)
   СтрокаТабличнойЧасти = Элементы.ПереченьНоменклатуры.ТекущиеДанные;
   РаботаСДокументами.РасчитатьСумму(СтрокаТабличнойЧасти);
КонецПроцедуры

&НаКлиенте
Процедура ПереченьНоменклатурыЦенаПриИзменении(Элемент)
   СтрокаТабличнойЧасти = Элементы.ПереченьНоменклатуры.ТекущиеДанные;
   РаботаСДокументами.РасчитатьСумму(СтрокаТабличнойЧасти);
КонецПроцедуры


Подсистема ОказаниеУслуг - Командный интерфейс
   Панель действий.Создать (включим видимость)
      Оказание услуги: создать (галочка)

На стр 153 показано как выглядит документ ОказаниеУслуги 

Запустим 1С платформу ( при прочтении книги первый раз, я умудрился этот момент упустить )
Создаем и заполняем документ 
   Транзистор Philips 2N2369        1,    3,  3

Провести и Закрыть 

Стр 154 - Документы - Теория 

Стр 211 Регистры накопления

Добавляем регистр накопления 
   РегистрНакопления - ОстаткиМатериалов, РПС - Движения по регистру Остатки материалов
   Подсистемы: Бухгалтерия, УчетМатериалов, ОказаниеУслуг
   Создадим измерения регистра
   Данные: 
      Измерения
         Материал, тип СправочникСсылка.Номенклатура
         Склад, тип СправочникСсылка.Склады
      Ресурсы
         Количество, длина 15 точность 3

   Формулируем движения регистра
   Идем в Документы - ПриходнаяНакладная - Движения, галочка ОстаткиМатериалов, заходим в Конструктор движений - Заполнить выражения - ОК
   Регистраторы - галочка ПриходнаяНакладная должна стоять 
   Подсистемы - Все подсистемы  
      Остатки материалов делаем видимой и переносим в Панель навигации 
      Делаем это в подсистемах УчетМатериалов, ОказаниеУслуг, Бухгалтерия

1с Платформа
   Видим что в подсистеме появился регистр Остатки материалов 
   Приходные накладные - 2 документа делаем Провести и закрыть 
   В остатки материалов видим проведенные документы
   Знак + указывается на тип Движения Прихода

1С Конфигурация
   Для удобства делаем так, что бы проведенные документы приходной накладной можно было видеть отдельно от других проведенных документов
   это сделаем для того, что бы не было путаницы в проведенных документах и проще можно будет ориентироваться
      Приходная накладная - Формы открыть - Командный интерфейс - Панель навигации - Перейти - Остатки материалов - Видимость галочка 
В платформе появилась ссылка остатки материалов только для ПриходнойНакладной 

Движение документа "Оказание услуги"
   
   Документ - ОказаниеУслуги
   Движения - отметим ОстаткиМатериалов
   Конструктор движения
      Тип движения Расход, Табличная часть - Перечень номенклатуры
      Материал заполнить вручную
      Маттерила(выделить) - ТекСтрокаПереченьНоменклатуры.Номенклатура(дважды нажиать)
      ОказаниеУслуги - Формы открыть - Командный интерфейс - Панель навигации - Перейти - Остатки материалов - Видимость галочка 

      Задание 8

Создание отчета
   
   Отчеты - Добавить - Материалы, Схема компановки  - Схема компановки данных - готово
   Добавить  набор даннных - запрос 
   Конструктор запроса 
      ОстаткиМатериалов.ОстаткиИОбороты - перетаскиваем в Таблицы и раскроем ее структуру
      Затем перетаскиваем в Поля Склад,Материал, КоличествоНачальныйОстаток, КоличествоПриход, КоличествоРасзод и в заключение КоличествоКонечныйОстаток - Ок

Настройки отчета
   Перейдем в закладку Настройки
      В дереве структуры отчета элемент Отчет(правой кнопкой мыши) - новая группировка
      Появится новая группировка "Детальные записи"
      В выбранные поля добавляем
         Склад
         Материал
         КоличествоНачальныйОстаток
         КоличествоПриход
         КоличествоРасход
         КоличествоКонечныйОстаток
      В параметрах ставил на элементы галочки и включаем в пользовательские настройки 
      что бы, перед формированием отчета пользователь мог указать период

   Подсистемы: Бухгалтерия, УчетМатериалов, ОказаниеУслуг
   Теперь отчет можно сформировать в платформе


Занятие 8 МАКЕТЫ



Макет печатной формы

Наша цель заключается в создании печатной формы документа Оказание услуги 

Как с помощью встроенного языка вывести в табличный документ новую область?
это вопрос на который я еще не ответил 


Создаем наш первый макет
   Заходим в документ: ОказаниеУслуги, переходим в Макеты, Конструкторы - запустить конструктор печати
      Имя команды - "Печать", Выбираем и переносим все реквизиты, которые будут испольховаться в шапке 
      Так же выбираем и переносим все реквизиты табличной части в наш макет
      Подвал пропускаем, он нам не нужен
      На последнем окне смотрим, что он предлагает команду Печать поместить в форму - Выбираем ОК
   Макет готов, 
   В форме документа видим, что появился в Командной панели Печать "Документ.ОказаниеУслуг.Команда.Печать"
   Проверяем Макет в 1С Платформе
   Теперь нам необхожимо сформировать итоговую сумму печати
   Заходим в макет, выделаем две строчки, даем им имя "Всего"
   Расшираем строки так, что бы они совпадали с нашей таблицей, как это делается в экселе
   В колонке Цена пишем "Всего", в Колонке Сумма пишем - ВсегоПоДокументу
   ВсегоПоДокументу - Параметр

   В Модуле менеджера редактируем код для того что бы считалась сумма документа, стр 260, не могу указать что писать в коде из за недостатка знаний


Занятие 9 ПЕРИОДИЧЕСКИЕ РЕГИСТРЫ СВЕДЕНИЙ

1С Конфигурация
   Регистры сведений - Добавить - Цены, Периодиченость - в пределах секунды,Представление записи - Цена, Представление Списка - Цены на номенклатуру, Режим записи - Независимый

   Подсистемы: Бухгалтерия, УчетМатериалов, ОказаниеУслуг

   Данные: 
   Измерение Номенклатура - СправочникСсылка.Номенклатура, Свойство - Ведущее
   Ресурс Цена, тип Число, длина 15, точность 2, неотрицательное

1С Платформа
   Заполняем данными Регистр Сведений - Цены на номенклатурау - стр 272

Наша цель 
   Что бы при заполнение документа Оказание услуг товаром, цена бралась из Регистра сведений за актуальную дату

1С Конфигурация
Создаем функцию РозничнаяЦена() и помещаем ее в общий модуль
   Общие модули - РаботаСоСправочниками, Сервер, Вызов сервера

Функция РозничнаяЦена(АктуальнаяДата, ЭлементНоменклатуры) Экспорт

   // Создать вспомогательный объект "Отбор".
   Отбор = Новый Структура("Номенклатура", ЭлементНоменклатуры);
   
   // Получить актуальные значения ресурсов регистра
   ЗначенияРесурсов = РегистрыСведений.Цены.ПолучитьПоследнее(АктуальнаяДата, Отбор);
   Возврат ЗначенияРесурсов.Цена;

КонецФункции

Задача 
   При редактировании документа ОказаниеУслуги нам необходимо обеспеить автоматическое заполнение поля Цена после того, как пользователь выберет услугу

   Документ - ОказаниеУслуги, ФормаДокумента 
      Выбираем ПереченьНоменклатурыНоменклатура - ПриИзменении - НаКлиенте 

Код 

&НаКлиенте
Процедура ПереченьНоменклатурыНоменклатураПриИзменении(Элемент)
   //Получить текущую строку табличной части
   СтрокаТабличнойЧасти = Элементы.ПереченьНоменклатуры.ТекущиеДанные;
   
   //Установить цену
   СтрокаТабличнойЧасти.Цена = РаботаСоСправочниками.РозничнаяЦена(Объект.Дата, СтрокаТабличнойЧасти.Номенклатура);
   
   // Пересчитать сумму строки
   РаботаСДокументами.РасчитатьСумму(СтрокаТабличнойЧасти);
КонецПроцедуры

Проверяем нашу работу
1С Платформа стр 278
   Добавляем в "Цены на номенклатуру" еще один транзистор и выставляем ему цены 
   Открываем документ Оказание услуги, добавляем этот транзистор выставляем дату, когда мы заполняли регистр сведений, добавляем транзистори и видим, что цену на транзистор документ взял из регистра сведений

Занятие 10 ПЕРЕЧИСЛЕНИЯ

Для того что бы определись чем является справояник Номенклатура, услугой или материалом, для этого нам необходим объект конфигурации Перечисление 




Как задать произвольное представление объекта конфигурации? 

Конфигурация
   Перечисление - добавить - Имя: ВидыНоменклатуры
      Данные:
         Материал
         Услуга

   Справочники
      Номенклатура 
         Данные - добавить реквизит "ВидНоменклатуры", Тип "ПеречисленияСсылка.ВидыНоменклатуры"

Платформа
   Заходим в номенклатуру и указываем номенклатуре Вид номенклатуры

Теперь мы хотим, что бы при выборе номенклатуры рядом указывался в скобках, Товар это или Услуга

Конфигуратор
   
   Номенклатура - Модуль менеджера
   Пишем код

   Процедура ОбработкаПолученияПолейПредставления(Поля,СтандартнаяОбработка)
   
      СтандартнаяОбработка = Ложь;
      Поля.Добавить("Наименование");
      Поля.Добавить("ВидНоменклатуры");
   
   КонецПроцедуры

   Процедура ОбработкаПолученияПредставления(Данные, Представление, СтандартнаяОбработка)
      
      СтандартнаяОбработка = Ложь;
         Если ЗначениеЗаполнено(Данные.ВидНоменклатуры) Тогда
            Представление = Данные.Наименование + "(" + НРег(Строка(Данные.ВидНоменклатуры)) + ")";

         Иначе 
            Представление = Данные.Наименование;
         КонецЕсли;

   КонецПроцедуры

Платформа

   В результате видим, как в документах при выборе номенклатура рядом в скобках указан его вид


Теперь мы должны сделать что бы при движении документа регистр наполнения заполнялся только номенклатурой, которая является материалом 

Конфигуратор
   
   Документы:
      ОказаниеУслуги - модуль объекта 
         // Добавляем в движение условие и все
Процедура ОбработкаПроведения(Отказ, Режим)
 
   Движения.ОстаткиМатериалов.Записывать = Истина;
   Для Каждого ТекСтрокаПереченьНоменклатуры Из ПереченьНоменклатуры Цикл 
      Если ТекСтрокаПереченьНоменклатуры.Номенклатура.ВидНоменклатуры =  Перечисления.ВидыНоменклатуры.Материал Тогда         
         Движение = Движения.ОстаткиМатериалов.Добавить();
         Движение.ВидДвижения = ВидДвиженияНакопления.Расход;
         Движение.Период = Дата;
         Движение.Материал = ТекСтрокаПереченьНоменклатуры.Номенклатура;
         Движение.Склад = Склад;
         Движение.Количество = ТекСтрокаПереченьНоменклатуры.Количество;  
      КонецЕсли;
   КонецЦикла;

КонецПроцедуры

Добавленный текст исключает выполнение операторов цикла для
тех строк табличной части документа, в которых номенклатура
не является материалом.

Платформа Стр 292
   Документ Оказание услуги удаляем старый объект
   Добавляем услугу и материал, проводим документ и смотрим результат


Занятие 11 ПРОВЕДЕНИЕ ДОКУМЕНТА ПО НЕСКОЛЬКИМ РЕГИСТРАМ

Конфигурация
   Регистр накопления - СтоимостьМатериалов, РПС - Движения по регистру Стоимость материалов
      Подсистемы: Бухгалтерия, УчетМатериалов и ОказаниеУслуг
      Данные: 
         Измерение - Материал, тип СправочникСсылка.Номенклатура
         Ресурс - Стоимость, тип Число, длина 15, точность 2

   Подсистемы 
      Все подсистемы
         В выбранных ранее подсистемах Стоимость материалов сделать видимой и перенести в группу Панель навигации

   Документ
      ПриходнаяНакладная
         Движения - поставить галочку на СтоимостьМатериалов
         Конструктор движений
            На вопрос отвечаем утвердительно
            Добавить в Регистры СтоимостьМатериалов
            Тип движения Приход, Табличная часть - Материалы

            Заполнить выражения
            добавить
            Стоимость - ТекСтрокаМатериалы.Сумма
            Ок

   Код, который создал Конструктор движения не очень оптимизированный, поэтому доводим его до идеала


   Процедура ОбработкаПроведения(Отказ, Режим)

      Движения.ОстаткиМатериалов.Записывать = Истина;
      Движения.СтоимостьМатериалов.Записывать = Истина;

      Для Каждого ТекСтрокаМатериалы Из Материалы Цикл 
         // Регистр ОстаткиМатериалов Приход
         Движение = Движения.ОстаткиМатериалов.Добавить();
         Движение.ВидДвижения = ВидДвиженияНакопления.Приход;
         Движение.Период = Дата;
         Движение.Материал = ТекСтрокаМатериалы.Материал;
         Движение.Склад = Склад;
         Движение.Количество = ТекСтрокаМатериалы.Количество; 
         
         // Регистр Стоимость Материалов Приход 
         Движение = Движения.СтоимостьМатериалов.Добавить();
         Движение.ВидДвижения = ВидДвиженияНакопления.Приход;
         Движение.Период = Дата;
         Движение.Материал = ТекСтрокаМатериалы.Материал;
         Движение.Стоимость = ТекСтрокаМатериалы.Сумма;
      КонецЦикла;

   КонецПроцедуры

   Теперь надо что бы Регистр накопления - Стоимость материалов отображался в форме
      ПриходняНакладная
         Формы - Открыть форму
            Командный интерфейс - Стоимость материалов поставить галочку видимость

Платформа
   Учет материалов
      Приходные накладные
         Выделяем все документы и проводим их
            Проверяем в как эти документы отображаются в регистрах 
            Остатки материала показывают количество материалов
            Стоимость материалов - показывают их стоимость
Проведение документа "Оказание услуги" по двум регистрам

Конфигуратор

   Документы
      ОказаниеУслуг
         Данны:  
            ПереченьНоменклатуры:
               Добавить - Стоимость, длина 15, точность 2, неотрицательное
      Далее добавляем ее на форму документа
         Формы
            Открыть форму  стр 307
              Перетащить из Реквизитах "Стоимость" в Элементы "ПереченьНоменклатуры", под "ПереченьНоменклатурыНоменклатура"

Теперь создадим движения документа ОказаниеУслуги 
   
   Документы
      ОказаниеУслуг
         Движения
            СтоимостьМатериалов(галочку поставить)

На этот раз конструктор использовать не будем, так как код до этого редактировали вручную

   Документы 
      ОказаниеУслуг - Модуль объекта

Вот так выглядит новый код


Процедура ОбработкаПроведения(Отказ, Режим)
   
   Движения.ОстаткиМатериалов.Записывать = Истина;
   Движения.СтоимостьМатериалов.Записывать = Истина;

   Для Каждого ТекСтрокаПереченьНоменклатуры Из ПереченьНоменклатуры Цикл 

      Если ТекСтрокаПереченьНоменклатуры.Номенклатура.ВидНоменклатуры = Перечисления.ВидыНоменклатуры.Материал Тогда     

         // Регистр ОстаткиМатериалов Расход
         Движение = Движения.ОстаткиМатериалов.Добавить();
         Движение.ВидДвижения = ВидДвиженияНакопления.Расход;
         Движение.Период = Дата;
         Движение.Материал = ТекСтрокаПереченьНоменклатуры.Номенклатура;
         Движение.Склад = Склад;
         Движение.Количество = ТекСтрокаПереченьНоменклатуры.Количество;
         
         // регистр СтоимостьМатериалов Расход
         Движение = Движения.СтоимостьМатериалов.Добавить();
         Движение.ВидДвижения = ВидДвиженияНакопления.Расход;
         Движение.Период = Дата;
         Движение.Материал = ТекСтрокаПереченьНоменклатуры.Номенклатура;
         Движение.Стоимость = ТекСтрокаПереченьНоменклатуры.Количество * ТекСтрокаПереченьНоменклатуры.Стоимость;
         
      КонецЕсли;
   КонецЦикла;

 КонецПроцедуры

Добавляем Стоимость материалов в форму документа Оказания услуг

   Документы
      ОказаниеУслуг
         Формы
            Открыть форму
               Командный интерфейс - Стоимость материалов (поставить галочку видимости)

Платформа стр 310

   Оказание услуги 
      Добавляем стоимость  Шлангу (100)
      Проводим документ
Далее лучше смотреть по книжке что и как он проводил


Занятие 12  ОБОРОТНЫЕ РЕГИСТРЫ НАКОПЛЕНИЯ
   
До сих пор мы создавали в регистрах накопления движения только для строк документа, которые содержат материалы. Услуги мы никак не учитывали


Конфигуратор
   РегистрНакопления
      Основные: Имя - Продажи,вид регистра Обороты, РПС - Движения по регистру Продажи
      Данные:
         Измерения:
            Номенклатура, тип СправочникСсылка.Номенклатура
            Клиент, тип СправочникСсылка.Клиент
            Мастер, тип СправочникСсылка.Сотрудники
         Ресурсы:
            Количество, тип Число, длина 15, точность 3
            Выручка, тип Число, длина 15, точность 2
            Стоимость, тип Число, длина 15, точность 2 
   Общие
      Подсистемы - Все подсистемы
         В выбранных ранее подсистемах - Продажи включить видимость и перенести в группу Панель навигации

Платформа
   ОказаниеУслуги - перепроводим все документы 

Конфигуратор
   
   Документ 
      ОказаниеУслуги - Модуль объекта 

В начале кода вставляем 

   Движения.Продажи.Записывать = Истина;

После КонецЕсли, но до конца Цикла вставим код 

   // Регистр Продажи
   Движение = Движения.Продажи.Добавить();
   Движение.Период = Дата;
   Движение.Номенклатура = ТекСтрокаПереченьНоменклатуры.Номенклатура;
   Движение.Клиент = Клиент;
   Движение.Мастер = Мастер;
   Движение.Количество = ТекСтрокаПереченьНоменклатуры.Количество;
   Движение.Выручка = ТекСтрокаПереченьНоменклатуры.Сумма;
   Движение.Стоимость = ТекСтрокаПереченьНоменклатуры.Стоимость * ТекСтрокаПереченьНоменклатуры.Количество;


   Формы
      Форма документа 
         Командный интерфейс - Панель навигации - Продажи - сделать видимым

Платформа
   Перепроводим документы, сравниваем со страницей 323



Занятие 13 - ОТЧЕТЫ,  продолжительность 4 часа 30 минут
Стр 327

Конфигуратор

Есть два способа доступа к данным в базе данных
   Объектный
      Реализован с посредством использования объектов встроенного языка
   Табличный
      Реализован с помощью запросов к базе данным, которые составляются на языке запросов


   Отчеты   
      Основные - РеестрДокументовОказаниеУслуги, РП - Список оказанных услуг, Открываем схему компановки данных
         Добавить набор данных - запрос


Как делать отчет я пока писать не буду



Занятие 14 Оптимизация проведения документа "Оказание услуги" стр 415


Цель:
   Оптимизация документа ОказаниеУслуги

   В обработчике события ОбработкаПроведения мы используем обращение к реквизиту ВидНоменклатуры справочника Номенклатура через точку, из за того скорость выполнения процедуры может замедлиться

   Так же расчет стоимости будем вычислять не вручную, а на автомате

   И Необзодимо контролировать остатки товаров, если остатков нет, то программа выведет сообщение об этом

Что бы повысить скорость выполнения документы мы испольщуем запросы


В 1С существуют деления на данные
   Объектные сущности
      Справочника, планы счетов, документы и т.д.
   Необъектные сущности
      Регистры сведений, регистры накопления и т.д.

   Документы
      ОказаниеУслуг - модуль объекта - редактируем его
      
Остановился на 446
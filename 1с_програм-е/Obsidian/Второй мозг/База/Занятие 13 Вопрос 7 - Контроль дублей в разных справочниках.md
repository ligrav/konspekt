
Занятие 13 Вопрос 7
 13 - март - 2024  16:57 
***Источник:***  [[Курс IronSkills]] 

***Заметка*** 
![[Pasted image 20240313165810.png]]
Модуль менеджера(наверное)
![[Pasted image 20240313175650.png]]
Пишем Код тут
Начинается с НайденныйКонтрагент
![[Pasted image 20240313175720.png]]

![[Pasted image 20240313175843.png]]

При нажатии просто на нынешнем контрагенте Записать
ошибок нет
![[Pasted image 20240313175912.png]]

При Создания Дубликата уже
ошибка есть
![[Pasted image 20240313175938.png]]
Код работает
Выносим код в общий модуль
что бы сделать его более универсальным

Общий модуль - РаботаСоСправочникамиСервер, копируем код в него


![[Pasted image 20240313180142.png]]
И теперь вызываем процедуру из справочника
![[Pasted image 20240313180158.png]]

Что бы сделать его более универсальным

Можно сделать имя справочника Параметром процедуры
Для этого используем метаданные

![[Pasted image 20240313180425.png]]

И снова вызываем, но теперь нам нужно при вызове больше параметров
И имя справочника берем из метаданных, ИмяСправочника - "Контрагенты"
И этот вызов может сработать в любом справочнике
![[Pasted image 20240313180607.png]]


И теперь в каждом справочнике есть контроль дублей
не самое лучшее решение, но уже не плохое

Есть возможность Вызов функции сделать еще интереснее
Для этого используется
Подписка на события 
![[Pasted image 20240313180838.png]]

![[Pasted image 20240313180901.png]]

![[Pasted image 20240313180932.png]]

И теперь мы вызываем его по другому 

![[Pasted image 20240313180948.png]]

![[Pasted image 20240313180955.png]]

В чем разница, до этого код был в трех модулях, но теперь он в одном
Но я пока все равно этого не очень понимаю

Подписка на события работает как Общий модуль


***Ключи:*** [[1С_Конфигурация]] [[2024 год]]  [[Занятие 13 Разбор вопросов]]